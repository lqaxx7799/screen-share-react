[{"D:\\qanh\\screen-share-react\\src\\index.js":"1","D:\\qanh\\screen-share-react\\src\\App.js":"2","D:\\qanh\\screen-share-react\\src\\components\\room.js":"3","D:\\qanh\\screen-share-react\\src\\components\\home.js":"4","D:\\qanh\\screen-share-react\\src\\components\\Room.js":"5","D:\\qanh\\screen-share-react\\src\\components\\Home.js":"6","D:\\qanh\\screen-share-react\\src\\components\\common\\index.js":"7","D:\\qanh\\screen-share-react\\src\\components\\common\\Button.js":"8","D:\\qanh\\screen-share-react\\src\\components\\Video.js":"9"},{"size":245,"mtime":1609387107966,"results":"10","hashOfConfig":"11"},{"size":390,"mtime":1609397584972,"results":"12","hashOfConfig":"11"},{"size":123,"mtime":1609386907468,"results":"13","hashOfConfig":"14"},{"size":123,"mtime":1609386913233,"results":"15","hashOfConfig":"14"},{"size":2557,"mtime":1609408374165,"results":"16","hashOfConfig":"11"},{"size":1067,"mtime":1609391632118,"results":"17","hashOfConfig":"11"},{"size":57,"mtime":1609388039303,"results":"18","hashOfConfig":"11"},{"size":235,"mtime":1609388064249,"results":"19","hashOfConfig":"11"},{"size":337,"mtime":1609400549403,"results":"20","hashOfConfig":"11"},{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"23"},"rtdk9s",{"filePath":"24","messages":"25","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"23"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1fnsmzz",{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"30","messages":"31","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32","usedDeprecatedRules":"33"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"23"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"38","messages":"39","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"42"},"D:\\qanh\\screen-share-react\\src\\index.js",[],["43","44"],"D:\\qanh\\screen-share-react\\src\\App.js",[],"D:\\qanh\\screen-share-react\\src\\components\\room.js",[],"D:\\qanh\\screen-share-react\\src\\components\\home.js",[],"D:\\qanh\\screen-share-react\\src\\components\\Room.js",["45"],"import React, { useEffect, useRef, useState } from 'react';\r\nimport io from 'socket.io-client';\r\nimport Peer from 'peerjs';\r\n\r\nconst Room = (props) => {\r\n  let socket = useRef(null);\r\n  let peer = useRef(null);\r\n  const [peers, setPeers] = useState({});\r\n\r\n  const ROOM_ID = props.match.params.id;\r\n  const videoRef = useRef(null);\r\n  const guestRefs = {};\r\n\r\n  const connectToNewUser = (userId, stream) => {\r\n    console.log('calling', userId, stream);\r\n    const call = peer.current.call(userId, stream);\r\n    call.on('stream', userVideoStream => {\r\n      console.log(111111111111);\r\n      addVideoStream(guestRefs[userId].current, userVideoStream);\r\n    });\r\n    call.on('close', () => {\r\n      guestRefs[userId].current.remove();\r\n    });\r\n    call.on('error', e => console.error(e));\r\n\r\n    setPeers({\r\n      ...peers,\r\n      [userId]: call,\r\n    });\r\n  }\r\n\r\n  const addVideoStream = (video, stream) => {\r\n    console.log(11111111, video);\r\n    video.srcObject = stream;\r\n    video.addEventListener('loadedmetadata', () => {\r\n      video.play();\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    socket.current = io('http://localhost:5001');\r\n    peer.current = new Peer(undefined, {\r\n      host: '/',\r\n      port: '5003',\r\n    });\r\n\r\n    navigator.mediaDevices.getDisplayMedia({\r\n      // video: {\r\n      //   cursor: 'always',\r\n      // },\r\n      video: true,\r\n      audio: false,\r\n    })\r\n      .then(stream => {\r\n        console.log('Me', peer.current.id);\r\n\r\n        addVideoStream(videoRef.current, stream);\r\n\r\n        peer.current.on('call', call => {\r\n          console.log('called');\r\n          call.answer(stream);\r\n          call.on('stream', userVideoStream => {\r\n            console.log('called', call.id);\r\n            addVideoStream(guestRefs[call.id].current, userVideoStream);\r\n          });\r\n        });\r\n      \r\n        socket.current.on('user-connected', userId => {\r\n          console.log('New user', userId);\r\n          connectToNewUser(userId, stream);\r\n        });\r\n      });\r\n\r\n    socket.current.on('user-disconnected', userId => {\r\n      if (peers[userId]) {\r\n        peers[userId].close();\r\n      }\r\n    });\r\n\r\n    peer.current.on('open', id => {\r\n      socket.current.emit('join-room', ROOM_ID, id);\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <div>Room</div>\r\n      <video className='screen-player' ref={videoRef}></video>\r\n      {Object.keys(peers).map((p, index) => (\r\n        <video key={index} className='screen-player' ref={ref => guestRefs[p] = ref}></video>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Room;\r\n",["46","47"],"D:\\qanh\\screen-share-react\\src\\components\\Home.js",[],"D:\\qanh\\screen-share-react\\src\\components\\common\\index.js",[],"D:\\qanh\\screen-share-react\\src\\components\\common\\Button.js",[],"D:\\qanh\\screen-share-react\\src\\components\\Video.js",[],["48","49"],{"ruleId":"50","replacedBy":"51"},{"ruleId":"52","replacedBy":"53"},{"ruleId":"54","severity":1,"message":"55","line":83,"column":6,"nodeType":"56","endLine":83,"endColumn":8,"suggestions":"57"},{"ruleId":"50","replacedBy":"58"},{"ruleId":"52","replacedBy":"59"},{"ruleId":"50","replacedBy":"60"},{"ruleId":"52","replacedBy":"61"},"no-native-reassign",["62"],"no-negated-in-lhs",["63"],"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'ROOM_ID', 'connectToNewUser', 'guestRefs', and 'peers'. Either include them or remove the dependency array.","ArrayExpression",["64"],["62"],["63"],["62"],["63"],"no-global-assign","no-unsafe-negation",{"desc":"65","fix":"66"},"Update the dependencies array to be: [ROOM_ID, connectToNewUser, guestRefs, peers]",{"range":"67","text":"68"},[2241,2243],"[ROOM_ID, connectToNewUser, guestRefs, peers]"]